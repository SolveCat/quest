<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<title>Status Krów</title>
<style>
  body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: #1e1e1e; color: #fff; display: flex; flex-wrap: wrap; justify-content: center; padding: 20px; }
  .cow { width: 80px; height: 80px; margin: 10px; border-radius: 10px; display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 20px; position: relative; cursor: default; transition: transform 0.3s; }
  .cow.green { background: #00ff00; }
  .cow.red { background: #ff4d4d; }
  .cow.gray { background: #999999; }
  .cow:hover { transform: scale(1.1); }
  .icon { position: absolute; top: 2px; right: 2px; width: 18px; height: 18px; }
</style>
</head>
<body>
<h1 style="width:100%; text-align:center;">Status Krów</h1>
<div id="cowContainer"></div>

<script>
const COW_COUNT = 50;
const endpoint = 'https://script.google.com/macros/s/AKfycbzSYei1DVy4yRctavPGt53Smi34qpM4JQwvTCPRQl6N-StItCvyRwA_fW5z5LWZI34FdQ/exec';

function loadStatus() {
  const container = document.getElementById('cowContainer');
  container.innerHTML = '';
  // JSONP request
  const script = document.createElement('script');
  script.src = endpoint + '?callback=showCows';
  document.body.appendChild(script);
}

function showCows(data) {
  const now = new Date();
  for(let i=1; i<=COW_COUNT; i++){
    const cowDiv = document.createElement('div');
    cowDiv.classList.add('cow', 'gray');
    cowDiv.textContent = i;
    const entry = data[i];
    if(entry){
      const entryTime = new Date(entry.timestamp);
      const diffH = (now - entryTime)/1000/60/60;
      if(diffH <= 10){
        cowDiv.classList.remove('gray');
        cowDiv.classList.add(entry.status === 'ok' ? 'green' : 'red');
      }
    }
    container.appendChild(cowDiv);
  }
}

loadStatus();
</script>
</body>
</html>
